<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fridge Guardian Dashboard</title>
  <script>
    // ESP32 IP address for API requests
    const ESP32_BASE = "http://192.168.1.176";
  </script>
  <script src="/www/lib/react.min.js"></script>
  <script src="/www/lib/react-dom.min.js"></script>
  <script src="/www/lib/babel.min.js"></script>
  <script src="/www/lib/tailwind.min.js"></script>
</head>
<body class="bg-gradient-to-br from-gray-900 to-gray-800 text-white min-h-screen">
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect } = React;

    function App() {
      const [data, setData] = useState({ tempF: null, voltage_mV: null, doorOpen: false, alarm: false });

      useEffect(() => {
        const fetchStatus = async () => {
          try {
            const res = await fetch(`${ESP32_BASE}/status`);
            const json = await res.json();
            setData(json);
          } catch (err) {
            console.error("Failed to fetch status:", err);
          }
        };
        fetchStatus();
        const interval = setInterval(fetchStatus, 2000);
        return () => clearInterval(interval);
      }, []);

      return (
        <div className="flex flex-col items-center justify-center h-screen text-center">
          <h1 className="text-3xl font-bold mb-6">Fridge Guardian Dashboard</h1>
          <div className="bg-gray-800 p-6 rounded-lg shadow-lg">
            <p className="text-xl">Temperature: <span className="font-bold text-blue-400">{data.tempF ? `${data.tempF.toFixed(1)} Â°F` : '...'}</span></p>
            <p className="mt-2">Voltage: {data.voltage_mV ? `${data.voltage_mV.toFixed(1)} mV` : '...'}</p>
            <p className="mt-2">Door: <span className={`font-semibold ${data.doorOpen ? 'text-red-400' : 'text-green-400'}`}>{data.doorOpen ? 'OPEN' : 'CLOSED'}</span></p>
            <p className="mt-2">Alarm: <span className={`font-semibold ${data.alarm ? 'text-red-400' : 'text-green-400'}`}>{data.alarm ? 'ON' : 'OFF'}</span></p>
          </div>
        </div>
      );
    }

    ReactDOM.render(<App />, document.getElementById("root"));
  </script>
</body>
</html>
